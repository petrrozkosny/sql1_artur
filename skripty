WITH rocni_data_cesko AS (
SELECT YEAR(datum) rok, SUM(srazky) suma_srazek
FROM
(
SELECT *
FROM data_nova
UNION ALL
SELECT *
FROM data_stara) dv
LEFT JOIN dim_oblasti do ON dv.lokalita = do.stanice 
WHERE do.zeme = 'Cesko'
GROUP BY YEAR(datum)
)
SELECT *
FROM rocni_data_cesko
WHERE suma_srazek > 5000;
